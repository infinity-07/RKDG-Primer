% 两相流问题
% 设置方程

clc,clear,close all
syms x y

g_epsa = 1.0e-2;
z1 = 0.5 + (0.5 - g_epsa) * sin(2*pi * (x+y- 2 * 0.00483311));
z2 = 1.0 - z1;

rho1 = 10.0;
rho2 = 1.0;
z1rho1 = rho1 * z1;
z2rho2 = rho2 * z2;
rho = z1rho1 + z2rho2;
u = 1;
v = 1;

uu = [z1rho1; z2rho2; rho*u; rho*v];


g_sc1 = 5.0;
g_sc2 = 5.0;
g_p0 = 0.0;
c1_2 = g_sc1 * g_sc1;
c2_2 = g_sc2 * g_sc2;
q = rho2 * c2_2 - rho1 * c1_2;
qs = z2rho2 * c2_2 - z1rho1 * c1_2;
r = ((q - qs) + sqrt((q - qs) * (q - qs) + 4.0 * z1rho1 * c1_2 * z2rho2 * c2_2)) / (2.0 * z2rho2 * c2_2);
z1 = r / (1.0 + r);
z2 = 1.0 - z1; 

sc = sqrt(rho * (z1 / (rho1 * c1_2) + z2 / (rho2 * c2_2)));
c = 1/sc;

c2 = c * c;

zrho1 = z1rho1 * c1_2 / (z1 * z1);
zrho2 = z2rho2 * c2_2 / (z2 * z2);
sc1_2 = c1_2 / z1 - c1_2 / z1 * zrho1 / (zrho1 + zrho2);
sc2_2 = c2_2 / z2 - c2_2 / z2 * zrho2 / (zrho1 + zrho2);

% 特征向量
eigMatrixL = [
    (sc1_2 + c * u) / (2.0 * c2),                  (sc2_2 + c * u) / (2.0 * c2),                 -1.0 / (2.0 * c),  0;
    -z2rho2 * (sc1_2 - sc2_2) / (rho * c2), z1rho1 * (sc1_2 - sc2_2) / (rho * c2),  0,                0;
    -v,                                    -v,                                   0,                1.0;
    (sc1_2 - c * u) / (2.0 * c2),                  (sc2_2 - c * u) / (2.0 * c2),                 1.0 / (2.0 * c),  0
    ];

% 投影并作图

f = eigMatrixL * uu;
f = matlabFunction(f(4))

x = linspace(0,1,51);
x = (x(1:end-1)+x(2:end))/2;
y = x;
[X,Y] = meshgrid(x,y);
Z = f(X,Y);
mesh(X,Y,Z)


% % df(x)
% duu = diff(uu,x);
% 
% df = eigMatrixL * duu;
% df = matlabFunction(df(2));
% x = linspace(0,1,51);
% x = (x(1:end-1)+x(2:end))/2;
% y = x;
% [X,Y] = meshgrid(x,y);
% Z = df(X,Y);
% mesh(X,Y,Z)



index = [0 11
0 11
0 12
0 12
0 13
0 13
0 36
0 36
0 37
0 37
0 38
0 38
1 10
1 10
1 11
1 11
1 12
1 12
1 35
1 35
1 36
1 36
1 37
1 37
2 9
2 9
2 10
2 10
2 11
2 11
2 34
2 34
2 35
2 35
2 36
2 36
3 8
3 8
3 9
3 9
3 10
3 10
3 33
3 33
3 34
3 34
3 35
3 35
4 7
4 7
4 8
4 8
4 9
4 9
4 32
4 32
4 33
4 33
4 34
4 34
5 6
5 6
5 7
5 7
5 8
5 8
5 31
5 31
5 32
5 32
5 33
5 33
6 5
6 5
6 6
6 6
6 7
6 7
6 30
6 30
6 31
6 31
6 32
6 32
7 4
7 4
7 5
7 5
7 6
7 6
7 29
7 29
7 30
7 30
7 31
7 31
8 3
8 3
8 4
8 4
8 5
8 5
8 28
8 28
8 29
8 29
8 30
8 30
9 2
9 2
9 3
9 3
9 4
9 4
9 27
9 27
9 28
9 28
9 29
9 29
10 1
10 1
10 2
10 2
10 3
10 3
10 26
10 26
10 27
10 27
10 28
10 28
11 0
11 0
11 1
11 1
11 2
11 2
11 25
11 25
11 26
11 26
11 27
11 27
12 0
12 0
12 1
12 1
12 24
12 24
12 25
12 25
12 26
12 26
12 49
12 49
13 0
13 0
13 23
13 23
13 24
13 24
13 25
13 25
13 48
13 48
13 49
13 49
14 22
14 22
14 23
14 23
14 24
14 24
14 47
14 47
14 48
14 48
14 49
14 49
15 21
15 21
15 22
15 22
15 23
15 23
15 46
15 46
15 47
15 47
15 48
15 48
16 20
16 20
16 21
16 21
16 22
16 22
16 45
16 45
16 46
16 46
16 47
16 47
17 19
17 19
17 20
17 20
17 21
17 21
17 44
17 44
17 45
17 45
17 46
17 46
18 18
18 18
18 19
18 19
18 20
18 20
18 43
18 43
18 44
18 44
18 45
18 45
19 17
19 17
19 18
19 18
19 19
19 19
19 42
19 42
19 43
19 43
19 44
19 44
20 16
20 16
20 17
20 17
20 18
20 18
20 41
20 41
20 42
20 42
20 43
20 43
21 15
21 15
21 16
21 16
21 17
21 17
21 40
21 40
21 41
21 41
21 42
21 42
22 14
22 14
22 15
22 15
22 16
22 16
22 39
22 39
22 40
22 40
22 41
22 41
23 13
23 13
23 14
23 14
23 15
23 15
23 38
23 38
23 39
23 39
23 40
23 40
24 12
24 12
24 13
24 13
24 14
24 14
24 37
24 37
24 38
24 38
24 39
24 39
25 11
25 11
25 12
25 12
25 13
25 13
25 36
25 36
25 37
25 37
25 38
25 38
26 10
26 10
26 11
26 11
26 12
26 12
26 35
26 35
26 36
26 36
26 37
26 37
27 9
27 9
27 10
27 10
27 11
27 11
27 34
27 34
27 35
27 35
27 36
27 36
28 8
28 8
28 9
28 9
28 10
28 10
28 33
28 33
28 34
28 34
28 35
28 35
29 7
29 7
29 8
29 8
29 9
29 9
29 32
29 32
29 33
29 33
29 34
29 34
30 6
30 6
30 7
30 7
30 8
30 8
30 31
30 31
30 32
30 32
30 33
30 33
31 5
31 5
31 6
31 6
31 7
31 7
31 30
31 30
31 31
31 31
31 32
31 32
32 4
32 4
32 5
32 5
32 6
32 6
32 29
32 29
32 30
32 30
32 31
32 31
33 3
33 3
33 4
33 4
33 5
33 5
33 28
33 28
33 29
33 29
33 30
33 30
34 2
34 2
34 3
34 3
34 4
34 4
34 27
34 27
34 28
34 28
34 29
34 29
35 1
35 1
35 2
35 2
35 3
35 3
35 26
35 26
35 27
35 27
35 28
35 28
36 0
36 0
36 1
36 1
36 2
36 2
36 25
36 25
36 26
36 26
36 27
36 27
37 0
37 0
37 1
37 1
37 24
37 24
37 25
37 25
37 26
37 26
37 49
37 49
38 0
38 0
38 23
38 23
38 24
38 24
38 25
38 25
38 48
38 48
38 49
38 49
39 22
39 22
39 23
39 23
39 24
39 24
39 47
39 47
39 48
39 48
39 49
39 49
40 21
40 21
40 22
40 22
40 23
40 23
40 46
40 46
40 47
40 47
40 48
40 48
41 20
41 20
41 21
41 21
41 22
41 22
41 45
41 45
41 46
41 46
41 47
41 47
42 19
42 19
42 20
42 20
42 21
42 21
42 44
42 44
42 45
42 45
42 46
42 46
43 18
43 18
43 19
43 19
43 20
43 20
43 43
43 43
43 44
43 44
43 45
43 45
44 17
44 17
44 18
44 18
44 19
44 19
44 42
44 42
44 43
44 43
44 44
44 44
45 16
45 16
45 17
45 17
45 18
45 18
45 41
45 41
45 42
45 42
45 43
45 43
46 15
46 15
46 16
46 16
46 17
46 17
46 40
46 40
46 41
46 41
46 42
46 42
47 14
47 14
47 15
47 15
47 16
47 16
47 39
47 39
47 40
47 40
47 41
47 41
48 13
48 13
48 14
48 14
48 15
48 15
48 38
48 38
48 39
48 39
48 40
48 40
49 12
49 12
49 13
49 13
49 14
49 14
49 37
49 37
49 38
49 38
49 39
49 39];
index = index(1:2:end,:)+1;
index = [index(:,2),index(:,1)];


hold on

for i = 1:size(index,1)
    X_(i) = X(index(i,1),index(i,2));
    Y_(i) = Y(index(i,1),index(i,2));
    Z_(i) = Z(index(i,1),index(i,2));
end
scatter3(X_,Y_,Z_)
view(40,35)